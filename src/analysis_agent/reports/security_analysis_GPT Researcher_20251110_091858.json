{
  "agent_name": "GPT Researcher",
  "framework": "FastAPI, Python 3.11+",
  "entry_point": "/home/shiqiu/gpt-researcher/main.py",
  "analysis_timestamp": "2025-11-10 09:18:58",
  "tools": [
    {
      "name": "write_report (backend)",
      "type": "report_generation",
      "description": "Generates research report and exports to docx and pdf",
      "position": "backend/server/server.py:write_report",
      "parameters": [
        "research_request",
        "research_id"
      ]
    },
    {
      "name": "upload_file (backend)",
      "type": "file_execution",
      "description": "Uploads user file to documents directory",
      "position": "backend/server/server.py:upload_file",
      "parameters": [
        "file"
      ]
    },
    {
      "name": "delete_file (backend)",
      "type": "file_execution",
      "description": "Deletes a file in the documents directory by filename",
      "position": "backend/server/server.py:delete_file",
      "parameters": [
        "filename"
      ]
    },
    {
      "name": "run_multi_agents (backend)",
      "type": "other",
      "description": "Runs multiple agents in parallel for research task",
      "position": "backend/server/server.py:run_multi_agents",
      "parameters": []
    },
    {
      "name": "handle_websocket_communication",
      "type": "other",
      "description": "Handles websocket messages, routes data between frontend and backend logic",
      "position": "backend/server/server_utils.py:handle_websocket_communication",
      "parameters": [
        "websocket",
        "manager"
      ]
    },
    {
      "name": "scrape_urls",
      "type": "web_browsing",
      "description": "Scrapes specified list of URLs for research",
      "position": "gpt_researcher/actions/web_scraping.py:scrape_urls",
      "parameters": [
        "urls",
        "config"
      ]
    },
    {
      "name": "get_search_results",
      "type": "web_browsing",
      "description": "Queries search engine retrievers for results to a query",
      "position": "gpt_researcher/actions/query_processing.py:get_search_results",
      "parameters": [
        "query",
        "retriever",
        "query_domains",
        "researcher"
      ]
    },
    {
      "name": "plan_research_outline",
      "type": "report_generation",
      "description": "Plans the research outline using the LLM based on the user query",
      "position": "gpt_researcher/actions/query_processing.py:plan_research_outline",
      "parameters": [
        "query"
      ]
    },
    {
      "name": "extract_headers",
      "type": "report_generation",
      "description": "Extracts headers from markdown text for report structuring",
      "position": "gpt_researcher/actions/markdown_processing.py:extract_headers",
      "parameters": [
        "markdown_text"
      ]
    },
    {
      "name": "extract_sections",
      "type": "report_generation",
      "description": "Extracts sections from markdown text for report structuring",
      "position": "gpt_researcher/actions/markdown_processing.py:extract_sections",
      "parameters": [
        "markdown_text"
      ]
    },
    {
      "name": "add_references",
      "type": "report_generation",
      "description": "Adds references to report markdown using visited URLs",
      "position": "gpt_researcher/actions/markdown_processing.py:add_references",
      "parameters": [
        "report_markdown",
        "visited_urls"
      ]
    }
  ],
  "dataflows": [
    {
      "source": "user_input",
      "destination": "report file, llm_prompt",
      "transformations": [
        "task is checked, processed for report generation"
      ],
      "sanitization": true
    },
    {
      "source": "user_input",
      "destination": "file_write",
      "transformations": [
        "file upload is sanitized and stored"
      ],
      "sanitization": true
    },
    {
      "source": "user_input",
      "destination": "file_delete",
      "transformations": [
        "filename sanitized then deleted"
      ],
      "sanitization": true
    },
    {
      "source": "user_input",
      "destination": "llm_prompt, api_call",
      "transformations": [
        "used for multi-agent, search, and data queries"
      ],
      "sanitization": true
    },
    {
      "source": "web_content",
      "destination": "llm_prompt, file_write",
      "transformations": [
        "used for scraping and report"
      ],
      "sanitization": true
    },
    {
      "source": "internal_data",
      "destination": "llm_prompt",
      "transformations": [
        "markdown processing, headers, sections"
      ],
      "sanitization": true
    }
  ],
  "vulnerabilities": [
    {
      "tool_name": "write_report (backend)",
      "position": "backend/server/server.py:write_report",
      "vulnerabilities": [
        "External data used in file operations"
      ],
      "injection_vectors": [
        {
          "type": "path_traversal",
          "source": "external_input",
          "destination": "file_operations"
        }
      ],
      "threat_model": [
        "path_traversal"
      ]
    },
    {
      "tool_name": "upload_file (backend)",
      "position": "backend/server/server.py:upload_file",
      "vulnerabilities": [
        "External data used in file operations"
      ],
      "injection_vectors": [
        {
          "type": "path_traversal",
          "source": "external_input",
          "destination": "file_operations"
        }
      ],
      "threat_model": [
        "path_traversal"
      ]
    },
    {
      "tool_name": "delete_file (backend)",
      "position": "backend/server/server.py:delete_file",
      "vulnerabilities": [
        "External data used in file operations"
      ],
      "injection_vectors": [
        {
          "type": "path_traversal",
          "source": "external_input",
          "destination": "file_operations"
        }
      ],
      "threat_model": [
        "path_traversal"
      ]
    },
    {
      "tool_name": "scrape_urls",
      "position": "gpt_researcher/actions/web_scraping.py:scrape_urls",
      "vulnerabilities": [
        "External data used in file operations"
      ],
      "injection_vectors": [
        {
          "type": "path_traversal",
          "source": "external_input",
          "destination": "file_operations"
        }
      ],
      "threat_model": [
        "path_traversal"
      ]
    },
    {
      "tool_name": "add_references",
      "position": "gpt_researcher/actions/markdown_processing.py:add_references",
      "vulnerabilities": [
        "External data used in file operations"
      ],
      "injection_vectors": [
        {
          "type": "path_traversal",
          "source": "external_input",
          "destination": "file_operations"
        }
      ],
      "threat_model": [
        "path_traversal"
      ]
    }
  ],
  "environment": {
    "requires_docker": true,
    "dependencies": [
      "aiofiles",
      "fastapi",
      "jinja2",
      "uvicorn",
      "beautifulsoup4",
      "langchain-core",
      "langchain-community",
      "langchain-openai",
      "langchain-ollama",
      "arxiv",
      "duckduckgo-search",
      "huggingface-hub",
      "httpx",
      "pydantic",
      "joblib",
      "python 3.11+"
    ],
    "runtime": "Python 3.11+, Docker, Linux/Unix (Chrome, Firefox, drivers installed per Dockerfile)"
  },
  "additional_notes": [
    "FastAPI is used with Jinja templates and CORS middleware.",
    "Extensive use of user input and file operations warrants careful path sanitization.",
    "No direct langchain or OpenAI API use found in code searches, but dependencies exist.",
    "Entry point (main.py) runs Uvicorn/App via backend.server.server:app"
  ]
}