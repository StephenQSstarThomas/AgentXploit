# Exploiter Agent Docker Configuration

# ============================================================================
# AgentDojo Configuration (COMMENTED OUT)
# ============================================================================
# docker:
#   name: "agentdojo-workspace"
#   image: "agentxploit-agentdojo"
#   command: "tail -f /dev/null"
#   detach: true
#   auto_remove: false
#   remove: true
#   environment:
#     MODEL: "gpt-4.1-2025-04-14"
#     OPENAI_API_KEY: "sk-Eav7rsFEDl480mnJwGL-4g"
#     OPENAI_BASE_URL: "https://litellm-991596698159.us-west1.run.app/v1"
#
# execution:
#   command: "bash get_report.sh -s workspace -ut user_task_5 -it injection_task_1"
#   report_path: /work/report.txt
#   local_dest: ./reports
#
# essential_files:
#   files: []
#   container_dest: "/work"

# ============================================================================
# OpenHands Configuration (ACTIVE)
# ============================================================================
docker:
  name: "openhands-app"
  image: "docker.all-hands.dev/all-hands-ai/openhands:0.49"
  command: null  # OpenHands自启动，不需要覆盖命令
  detach: true
  auto_remove: false
  remove: true
  environment:
    SANDBOX_RUNTIME_CONTAINER_IMAGE: "docker.all-hands.dev/all-hands-ai/runtime:0.49-nikolaik"
    LOG_ALL_EVENTS: "true"
  volumes:
    /run/user/2050/docker.sock:
      bind: /var/run/docker.sock
      mode: rw
    /home/shiqiu/OpenHands/shared:
      bind: /shared
      mode: rw
  extra_hosts:
    - "host.docker.internal:169.229.219.180"

# Execution command to run inside container
execution:
  command: "cd /workspace && chmod +x test_run.py && python3 test_run.py --max-iterations 10"
  report_path: "/shared/trajectories"  # 目录路径，会自动查找最新JSON文件
  local_dest: "./reports/openhands"

# Essential files to copy to container before execution
essential_files:
  files:
    - local: "/home/shiqiu/OpenHands/test_run.py"
      container: "/workspace/test_run.py"
    - local: "/home/shiqiu/OpenHands/config.toml"
      container: "/workspace/config.toml"
    - local: "/home/shiqiu/OpenHands/test.json"
      container: "/workspace/test.json"
  container_dest: "/workspace"
